function valeq=case7Int(E1,E12,E3,NM)
    if real(E1*NM)<-20*log(10) && real(E3*NM)<-20*log(10)
        % this will be killed by j sum
        valeq=0;
        return 
    end
    
    % on same monomer
    MIN=(10^-4)/NM;    
    
    vec=[E1,E12,E3];
    nzeros=sum(abs(vec)<MIN);
    if nzeros==3
        valeq=NM^4*(-NM*(E1-2*E12+E3)+6)/12;
    elseif nzeros==2
        if max(abs([E1,E12]))<MIN
            valeq=NM*(2*(E1+E12+E3)*(expl(1,NM*E3)+expl(1,-NM*E3))...
                    +NM*E3*(2*E3+NM*E3*E12+2*E12+E1*(exp(NM*E3)+1))*expl(1,-NM*E3))...
                    /(2*E3^4);
        elseif max(abs([E12,E3]))<MIN
            valeq=NM*(2*(E1+E12+E3)*(expl(1,NM*E1)+expl(1,-NM*E1))...
                    +NM*E1*(2*E1+NM*E1*E12+2*E12+E3*(exp(NM*E1)+1))*expl(1,-NM*E1))...
                    /(2*E1^4);
        elseif max(abs([E1,E3]))<MIN
            valeq=NM^2*(2*(E1+E12+E3)*expl(2,NM*E12)-NM*(E1+E3)*E12*expl(1,NM*E12))/(2*E12^3);
        else
            error('not an option')
        end
    elseif nzeros==1
        if abs(E1-E12)<MIN && abs(E3)<MIN
            valeq=(NM^2*E1*expl(2,NM*E1)-NM*(expl(3,NM*E1)+expl(3,-NM*E1)))/(E1^3);
        elseif abs(E12-E3)<MIN && abs(E1)<MIN
            valeq=(NM^2*E3*expl(2,NM*E3)-NM*(expl(3,NM*E3)+expl(3,-NM*E3)))/(E3^3);
        elseif abs(E1-E3)<MIN && abs(E12)<MIN
            valeq=(expl(4,-2*NM*E1)+(NM*E1-1)*expl(4,NM*E1)+(NM*E1-3)*expl(4,-NM*E1))/(E1^4);
        elseif abs(E1)<MIN
            valeq=-NM*(E12*expl(2,NM*E3)+E12*expl(2,-NM*E3)+E3*expl(1,NM*E12)*expl(1,-NM*E3))/(E12*E3^2*(E12-E3));
        elseif abs(E12)<MIN   
            valeq=(E1*expl(2,NM*E3)-E3*expl(2,NM*E1))*expl(1,-NM*E3)*expl(1,-NM*E1)/(-E1^2*E3^2*(E1-E3));
        elseif abs(E3)<MIN
            valeq=-NM*(E12*expl(2,NM*E1)+E12*expl(2,-NM*E1)+E1*expl(1,NM*E12)*expl(1,-NM*E1))/(E12*E1^2*(E12-E1));
        else
            error('not an option')
        end
    else
        if (abs(E1-E12)<MIN && abs(E12-E3)<MIN)
           valeq=(1/2).*(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).^2.* ...
           NM.^2.*log(exp(1).^E1).^(-2);
        elseif abs(E1-E12)<MIN
           valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
           1).^E3).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+(-1) ...
           .*log(exp(1).^E3)).^(-2).*log(exp(1).^E3).^(-1).*((exp(1).^E3) ...
           .^NM+(exp(1).^E1).^NM.*((-1)+NM.*log(exp(1).^E1)+(-1).*NM.*log( ...
           exp(1).^E3)));
        elseif abs(E1-E3)<MIN
           valeq=(exp(1).^E1).^((-2).*NM).*((-1)+(exp(1).^E1).^NM).^2.*log(exp(1) ...
           .^E1).^(-2).*(log(exp(1).^E1)+(-1).*log(exp(1).^E12)).^(-2).*(( ...
           exp(1).^E12).^NM+(exp(1).^E1).^NM.*((-1)+NM.*log(exp(1).^E1)+(-1) ...
           .*NM.*log(exp(1).^E12)));
            flage=1;
        elseif abs(E12-E3)<MIN
           valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
           1).^E12).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+( ...
           -1).*log(exp(1).^E12)).^(-2).*log(exp(1).^E12).^(-1).*((exp(1) ...
           .^E1).^NM+(-1).*(exp(1).^E12).^NM+(-1).*(exp(1).^E12).^NM.*NM.* ...
           log(exp(1).^E1)+(exp(1).^E12).^NM.*NM.*log(exp(1).^E12));
        else
           valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
           1).^E3).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+(-1) ...
           .*log(exp(1).^E12)).^(-1).*(log(exp(1).^E1)+(-1).*log(exp(1).^E3)) ...
           .^(-1).*log(exp(1).^E3).^(-1).*((-1).*log(exp(1).^E12)+log(exp(1) ...
           .^E3)).^(-1).*(((exp(1).^E12).^NM+(-1).*(exp(1).^E3).^NM).*log( ...
           exp(1).^E1)+((-1).*(exp(1).^E1).^NM+(exp(1).^E3).^NM).*log(exp(1) ...
           .^E12)+((exp(1).^E1).^NM+(-1).*(exp(1).^E12).^NM).*log(exp(1).^E3) ...
           );
        end
    end    
    
    
%{    
    % on same monomer
    MIN=(10^-4)/NM;
    flage=0;
    if max(abs([E1,E12,E3]))<MIN
        valeq=NM^4*(-NM*(E1-2*E12+E3)+6)/12;
    elseif max(abs([E1,E12]))<MIN
        valeq=NM*(2*(E1+E12+E3)*(expl(1,NM*E3)+expl(1,-NM*E3))...
                +NM*E3*(2*E3+NM*E3*E12+2*E12+E1*(exp(NM*E3)+1))*expl(1,-NM*E3))...
                /(2*E3^4);
    elseif max(abs([E12,E3]))<MIN
        valeq=NM*(2*(E1+E12+E3)*(expl(1,NM*E1)+expl(1,-NM*E1))...
                +NM*E1*(2*E1+NM*E1*E12+2*E12+E3*(exp(NM*E1)+1))*expl(1,-NM*E1))...
                /(2*E1^4);
    elseif max(abs([E1,E3]))<MIN
        valeq=NM^2*(2*(E1+E12+E3)*expl(2,NM*E12)-NM*(E1+E3)*E12*expl(1,NM*E12))/(2*E12^3);
    elseif (abs(E1-E12)<MIN && abs(E12-E3)<MIN)
       valeq=(1/2).*(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).^2.* ...
       NM.^2.*log(exp(1).^E1).^(-2);
    elseif abs(E1-E12)<MIN
       valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
       1).^E3).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+(-1) ...
       .*log(exp(1).^E3)).^(-2).*log(exp(1).^E3).^(-1).*((exp(1).^E3) ...
       .^NM+(exp(1).^E1).^NM.*((-1)+NM.*log(exp(1).^E1)+(-1).*NM.*log( ...
       exp(1).^E3)));
    elseif abs(E1-E3)<MIN
       valeq=(exp(1).^E1).^((-2).*NM).*((-1)+(exp(1).^E1).^NM).^2.*log(exp(1) ...
       .^E1).^(-2).*(log(exp(1).^E1)+(-1).*log(exp(1).^E12)).^(-2).*(( ...
       exp(1).^E12).^NM+(exp(1).^E1).^NM.*((-1)+NM.*log(exp(1).^E1)+(-1) ...
       .*NM.*log(exp(1).^E12)));
        flage=1;
    elseif abs(E12-E3)<MIN
       valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
       1).^E12).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+( ...
       -1).*log(exp(1).^E12)).^(-2).*log(exp(1).^E12).^(-1).*((exp(1) ...
       .^E1).^NM+(-1).*(exp(1).^E12).^NM+(-1).*(exp(1).^E12).^NM.*NM.* ...
       log(exp(1).^E1)+(exp(1).^E12).^NM.*NM.*log(exp(1).^E12));
    else
       valeq=(exp(1).^E1).^((-1).*NM).*((-1)+(exp(1).^E1).^NM).*(1+(-1).*(exp( ...
       1).^E3).^((-1).*NM)).*log(exp(1).^E1).^(-1).*(log(exp(1).^E1)+(-1) ...
       .*log(exp(1).^E12)).^(-1).*(log(exp(1).^E1)+(-1).*log(exp(1).^E3)) ...
       .^(-1).*log(exp(1).^E3).^(-1).*((-1).*log(exp(1).^E12)+log(exp(1) ...
       .^E3)).^(-1).*(((exp(1).^E12).^NM+(-1).*(exp(1).^E3).^NM).*log( ...
       exp(1).^E1)+((-1).*(exp(1).^E1).^NM+(exp(1).^E3).^NM).*log(exp(1) ...
       .^E12)+((exp(1).^E1).^NM+(-1).*(exp(1).^E12).^NM).*log(exp(1).^E3) ...
       );
    end

%     valeq=expl(1,-NM*E1)*expl(1,-NM*E3)*(...
%           (expl(2,NM*E3)-expl(2,NM*E12))*(E1-E3)+...
%           (expl(2,NM*E1)-expl(2,NM*E3))*(E12-E3))/...
%           ( E1*E3*(E12-E3)*(E1-E3)*(E1-E12) );
%}    
    % on different monomers
    
    if isnan(valeq)
        sprintf('E1=%g+%gi,E12=%g+%gi,E3=%g+%gi, NM=%g, flage=%d',...
                real(E1),imag(E1),real(E12),imag(E12),real(E3),imag(E3),NM,flage)
        error('NaN encountered')
    end
end